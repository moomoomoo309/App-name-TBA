#:kivy 1.9

#:import calendar calendar
#:import date datetime.date
#:import datetime datetime.datetime
#:import MonthCyclicRoulette eventGUI.MonthCyclicRoulette
#:import DayCyclicRoulette eventGUI.DayCyclicRoulette

<inputLine@BoxLayout>:
    orientation: "horizontal"
    id: layout
    output: textinput.text

    Label:
        size: self.texture_size
        text: layout.text
        size_hint_x: .25

    TextInput:
        id: textinput

<picker@BoxLayout>:
    orientation: "horizontal"
    id: layout
    size_hint_y: 3
    date: datetime(year=yearpicker.selected_value, month=int(abs(monthpicker.selected_value))%max(len(monthpicker.values),1)+1, day=daypicker.selected_value, hour=(timepicker.hours)%12+(12 if not timepicker._am else 0), minute=timepicker.minutes)
    Label:
        halign: "center"
        valign: "middle"
        size_hint_x: .175
        size: self.texture_size
        text: layout.text+ "\n" + monthpicker.values[int(abs(monthpicker.selected_value))%max(len(monthpicker.values),1)] +" "+ str(daypicker.selected_value)+", "+str(yearpicker.selected_value) + "\n" + ("0" if (timepicker.hours-1)%12+1<10 else "")+str((timepicker.hours-1)%12+1)+":"+("0" if timepicker.minutes<10 else "")+str(timepicker.minutes)+" "+("AM" if timepicker._am else "PM")

    CyclicRoulette:
        id: yearpicker
        background_color: (.1568,.1568,.1568,1)
        cycle: date.today().year+50
        selected_value: date.today().year
        density: 5
        size_hint_x: .2

    MonthCyclicRoulette:
        id: monthpicker
        background_color: (.1568,.1568,.1568,1)
        selected_value: date.today().month-1
        int_valued: True
        density: 5
        size_hint_x: .2

    DayCyclicRoulette:
        id: daypicker
        background_color: (.1568,.1568,.1568,1)
        selected_value: date.today().day
        cycle: calendar.monthrange(yearpicker.selected_value, int(abs(monthpicker.selected_value)%len(monthpicker.values))+1)[1]
        density: 5
        size_hint_x: .2

    CircularTimePicker:
        id: timepicker
        minutes: datetime.now().minute
        _am: datetime.now().hour<=12
        hours: datetime.now().hour
        size_hint_x: .1

<dropDown@BoxLayout>:
    id: layout
    orientation: "horizontal"
    size_hint_y: 2
    output: str(every.selected_value)+" "+str(int(abs(unitpicker.selected_value))%max(len(unitpicker.values),1))

    Label:
        text: "Repeat every"
        size: self.texture_size
        size_hint_x:.25

    CyclicRoulette:
        id: every
        background_color: (.1568,.1568,.1568,1)
        cycle: 100
        selected_value: 15
        density: 2.5
        size_hint_x: .5

    timeCyclicRoulette:
        background_color: (.1568,.1568,.1568,1)
        id: unitpicker
        int_valued: True
        selected_value: 1
        cycle: len(self.values)
        density: 2.5
        size_hint_x: .5